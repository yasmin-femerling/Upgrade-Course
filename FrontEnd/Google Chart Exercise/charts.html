<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Chart Custom Element</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <!--Load the AJAX API-->
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script>

    
    // Callback that creates and populates a data table, 
    // instantiates the chart, passes in the data and
    // draws it.
    function drawChart() {
        //Use a json Data source
        //Source of json given by 'data-source' attribute
        var jsonData = $.ajax({
            url:this.getAttribute('data-source'),
            dataType: "json",
            async: false
        }).responseText;

        // Create our data table out of JSON data loaded from server.
        var data = new google.visualization.DataTable(jsonData);
        // Set chart options
        //Title comes from tag 'title' attribute
        var options = {'title':this.getAttribute('title')};

        // Instantiate and draw our chart, passing in some options.
        //Attribute 'type' declares the type of chart to be used
        switch(this.getAttribute('type')) {
            case 'column':
                var chart = new google.visualization.ColumnChart(this);
                break;
            default:
                var chart = new google.visualization.PieChart(this);
        }

        //draw chart
        chart.draw(data, options);
    }

    class GoogleChart extends HTMLElement {
        connectedCallback() {
            console.log('Adding a chart!');
            drawChart.call(this);
        } 
    }

    google.charts.load('current', {packages: ['corechart']});
    google.charts.setOnLoadCallback(() => {
        console.log('Google Charts loaded.');
        customElements.define('google-chart', GoogleChart);
    });

    </script>
</head>
<body>
<div class="p-5">
    <h1>Custom Element - Google Charts</h1>
    <h3>Using JSON Data Source</h3>

    <h5>Pie Chart</h5>
    <google-chart type="pie" data-source="data.json" title="Pie Chart of Atos Coders"></google-chart>
    <h5>Column Chart</h5>
    <google-chart type="column" data-source="data1.json" title="Column Chart Stock of Products"></google-chart>
</div>
</body>
</html>